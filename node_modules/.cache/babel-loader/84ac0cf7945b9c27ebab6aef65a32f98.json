{"ast":null,"code":"var _jsxFileName = \"/home/dmitriy/WebstormProjects/react-mesto-auth/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport Header from \"./Header\";\nimport Main from \"./Main\";\nimport Footer from \"./Footer\";\nimport PopupWithForm from \"./PopupWithForm\";\nimport ImagePopup from \"./ImagePopup\";\nimport { useEffect, useState } from \"react\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext\";\nimport { renderResponse } from \"../utils/apiFunctions\";\nimport { api } from \"../utils/Api\";\nimport * as authApi from '../utils/authApi';\nimport { EditProfilePopup } from \"./EditProfilePopup\";\nimport { EditAvatarPopup } from \"./EditAvatarPopup\";\nimport { AddPlacePopup } from \"./AddPlacePopup\";\nimport { Route, Switch, useHistory } from 'react-router-dom';\nimport { ProtectedComponent } from \"./ProtectedComponent\";\nimport { Register } from \"./Register\";\nimport { Login } from \"./Login\";\nimport { AuthnNotificationPopup } from \"./AuthNotificationPopup\";\nimport successIcon from \"../source/images/svg-images/success-icon.svg\";\nimport errorIcon from \"../source/images/svg-images/error-icon.svg\";\nimport { AuthContext } from \"../contexts/AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [currentUser, setCurrentUser] = useState({\n    about: '',\n    avatar: '',\n    cohort: '',\n    name: '',\n    _id: '',\n    email: ''\n  }); // хук для навигации с помощью brouser router\n\n  const history = useHistory();\n  const [editProfileState, setEditProfileState] = useState(false);\n  const [editAvatarState, setEditAvatarState] = useState(false);\n  const [addPlaceState, setAddPlaceState] = useState(false);\n  const [successfulRegState, setSuccessfulRegState] = useState(false);\n  const [errorRegState, setErrorRegState] = useState(false);\n  const [selectedCard, setSelectedCard] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [emailNav, setEmailNav] = useState('');\n\n  function finallyHandler() {\n    setIsLoading(false);\n  } // стейт карточек\n\n\n  const [cards, setCards] = useState([]);\n  useEffect(() => {\n    renderResponse(api.getPreloadsCards(), data => {\n      setCards(data);\n    }, \"#\");\n    renderResponse(api.getUserInfo(), data => {\n      setCurrentUser({ ...currentUser,\n        about: data.about,\n        avatar: data.avatar,\n        cohort: data.cohort,\n        name: data.name,\n        _id: data._id\n      });\n    }, \"#\");\n\n    if (localStorage.getItem('jwt')) {\n      const jwt = localStorage.getItem('jwt');\n      authApi.getUserCredentials(jwt).then(_ref => {\n        let {\n          email,\n          _id\n        } = _ref;\n        handleLoggedIn();\n        handleEmailNav(email);\n        history.push('/');\n      });\n    }\n  }, []); // функции обратного вызова для управления поведением карточки\n\n  const handleCardLike = card => {\n    const isLiked = card.likes.some(like => like._id === currentUser._id);\n    renderResponse(api.changeLikeCardStatus(card._id, !isLiked), newCard => {\n      setCards(prevState => {\n        return prevState.map(stateItem => {\n          return stateItem._id === card._id ? newCard : stateItem;\n        });\n      });\n    }, finallyHandler);\n  };\n\n  const handleCardDelete = card => {\n    renderResponse(api.deleteCard(card._id), () => {\n      setCards(prevState => {\n        return prevState.filter(stateItem => stateItem._id !== card._id);\n      });\n    }, finallyHandler);\n  };\n\n  const handleAddMestoCard = _ref2 => {\n    let {\n      name,\n      link\n    } = _ref2;\n    setIsLoading(true);\n    renderResponse(api.postCard({\n      name: name,\n      link: link\n    }), newCardData => {\n      setCards([newCardData, ...cards]);\n      setIsLoading(false);\n      closeAllPopups();\n    }, finallyHandler);\n  }; // функции обратного вызова для управления данными пользователя\n\n\n  const handleUpdateUser = _ref3 => {\n    let {\n      name,\n      about\n    } = _ref3;\n    setIsLoading(true);\n    renderResponse(api.updateUserInfo({\n      fio: name,\n      aboutYourself: about\n    }), data => {\n      setCurrentUser({ ...currentUser,\n        name: data.name,\n        about: data.about\n      });\n      setIsLoading(false);\n      closeAllPopups();\n    }, finallyHandler);\n  };\n\n  const handleUpdateAvatar = _ref4 => {\n    let {\n      avatar\n    } = _ref4;\n    setIsLoading(true);\n    renderResponse(api.updateAvatar({\n      avatar\n    }), data => {\n      setCurrentUser({ ...currentUser,\n        avatar: data.avatar\n      });\n      setIsLoading(false);\n      closeAllPopups();\n    }, finallyHandler);\n  }; //обработчики для стейта авторизации\n\n\n  const handleLoggedIn = () => {\n    setAuthUser({ ...authUser,\n      isLoggedIn: true\n    });\n  };\n\n  const handleLoggOut = () => {\n    setAuthUser({ ...authUser,\n      isLoggedIn: false\n    });\n  };\n\n  const handleEmailNav = value => {\n    setEmailNav(value);\n  };\n\n  const [authUser, setAuthUser] = useState({\n    isLoggedIn: false,\n    handleLogin: handleLoggedIn,\n    handleQuit: handleLoggOut,\n    handleEmailNav: handleEmailNav\n  }); // функции обратного вызова для открытия/закрытия попапов\n\n  const handleEditAvatarClick = () => {\n    setEditAvatarState(true);\n  };\n\n  const handleEditProfileClick = () => {\n    setEditProfileState(true);\n  };\n\n  const handleAddPlaceClick = () => {\n    setAddPlaceState(true);\n  };\n\n  const handleSuccessfullReg = () => {\n    setSuccessfulRegState(true);\n  };\n\n  const handleErrorReg = () => {\n    setErrorRegState(true);\n  };\n\n  const closeAllPopups = () => {\n    setEditProfileState(false);\n    setAddPlaceState(false);\n    setEditAvatarState(false);\n    setSuccessfulRegState(false);\n    setErrorRegState(false);\n    setSelectedCard({});\n  };\n\n  const handleCardClick = card => {\n    setSelectedCard(card);\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: authUser,\n    children: /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n      value: currentUser,\n      children: [/*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(ProtectedComponent, {\n          component: Main,\n          path: \"/\",\n          emailNav: emailNav,\n          exact: true,\n          onEditProfile: handleEditProfileClick,\n          onAddPlace: handleAddPlaceClick,\n          onEditAvatar: handleEditAvatarClick,\n          onCardClick: handleCardClick,\n          onCardLike: handleCardLike,\n          onCardDelete: handleCardDelete,\n          cards: cards\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/sign-up\",\n          children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 23\n          }, this), /*#__PURE__*/_jsxDEV(Register, {\n            onSuccessfullReg: handleSuccessfullReg,\n            onErrorReg: handleErrorReg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/sign-in\",\n          children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 23\n          }, this), /*#__PURE__*/_jsxDEV(Login, {\n            onErrorLoggedIn: handleErrorReg,\n            onEmail: handleEmailNav\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: editProfileState,\n        onClose: closeAllPopups,\n        onUserUpdate: handleUpdateUser,\n        isLoading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: editAvatarState,\n        onClose: closeAllPopups,\n        onUpdateAvatar: handleUpdateAvatar,\n        isLoading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n        isOpen: addPlaceState,\n        onClose: closeAllPopups,\n        onAddCard: handleAddMestoCard,\n        isLoading: isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(PopupWithForm, {\n        name: \"confirm\",\n        title: \"Вы уверены?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n        card: selectedCard,\n        onClose: closeAllPopups\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(AuthnNotificationPopup, {\n        name: \"success-register\",\n        isOpen: successfulRegState,\n        onClose: closeAllPopups,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"popup__reg-icon\",\n          src: successIcon,\n          alt: \"\\u0418\\u043A\\u043E\\u043D\\u043A\\u0430 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E\\u0439 \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"popup__title popup__title_color_black popup__title_type_notification\",\n          children: \"\\u0412\\u044B \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u0437\\u0430\\u0440\\u0435\\u0433\\u0435\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043B\\u0438\\u0441\\u044C!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(AuthnNotificationPopup, {\n        name: \"error-register\",\n        isOpen: errorRegState,\n        onClose: closeAllPopups,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"popup__reg-icon\",\n          src: errorIcon,\n          alt: \"\\u0418\\u043A\\u043E\\u043D\\u043A\\u0430 \\u043D\\u0435\\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E\\u0439 \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"popup__title popup__title_color_black popup__title_type_notification\",\n          children: \"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A! \\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0435\\u0449\\u0451 \\u0440\\u0430\\u0437.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 19\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 159,\n    columnNumber: 7\n  }, this);\n}\n\n_s(App, \"wlIXZ5vGwgGfo2sOmNakjSv5Jhg=\", false, function () {\n  return [useHistory];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/dmitriy/WebstormProjects/react-mesto-auth/src/components/App.js"],"names":["Header","Main","Footer","PopupWithForm","ImagePopup","useEffect","useState","CurrentUserContext","renderResponse","api","authApi","EditProfilePopup","EditAvatarPopup","AddPlacePopup","Route","Switch","useHistory","ProtectedComponent","Register","Login","AuthnNotificationPopup","AuthContext","App","currentUser","setCurrentUser","about","avatar","cohort","name","_id","email","history","editProfileState","setEditProfileState","editAvatarState","setEditAvatarState","addPlaceState","setAddPlaceState","successfulRegState","setSuccessfulRegState","errorRegState","setErrorRegState","selectedCard","setSelectedCard","isLoading","setIsLoading","emailNav","setEmailNav","finallyHandler","cards","setCards","getPreloadsCards","data","getUserInfo","localStorage","getItem","jwt","getUserCredentials","then","handleLoggedIn","handleEmailNav","push","handleCardLike","card","isLiked","likes","some","like","changeLikeCardStatus","newCard","prevState","map","stateItem","handleCardDelete","deleteCard","filter","handleAddMestoCard","link","postCard","newCardData","closeAllPopups","handleUpdateUser","updateUserInfo","fio","aboutYourself","handleUpdateAvatar","updateAvatar","setAuthUser","authUser","isLoggedIn","handleLoggOut","value","handleLogin","handleQuit","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleSuccessfullReg","handleErrorReg","handleCardClick","successIcon","errorIcon"],"mappings":"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","sourcesContent":["import Header from \"./Header\";\nimport Main from \"./Main\";\nimport Footer from \"./Footer\";\nimport PopupWithForm from \"./PopupWithForm\";\nimport ImagePopup from \"./ImagePopup\";\nimport {useEffect, useState} from \"react\";\nimport {CurrentUserContext} from \"../contexts/CurrentUserContext\";\nimport {renderResponse} from \"../utils/apiFunctions\";\nimport {api} from \"../utils/Api\";\nimport * as authApi from '../utils/authApi';\nimport {EditProfilePopup} from \"./EditProfilePopup\";\nimport {EditAvatarPopup} from \"./EditAvatarPopup\";\nimport {AddPlacePopup} from \"./AddPlacePopup\";\nimport {Route, Switch, useHistory} from 'react-router-dom'\nimport {ProtectedComponent} from \"./ProtectedComponent\";\nimport {Register} from \"./Register\";\nimport {Login} from \"./Login\";\nimport {AuthnNotificationPopup} from \"./AuthNotificationPopup\";\nimport successIcon from '../source/images/svg-images/success-icon.svg';\nimport errorIcon from '../source/images/svg-images/error-icon.svg';\nimport {AuthContext} from \"../contexts/AuthContext\";\n\nfunction App() {\n\n    const [currentUser, setCurrentUser] = useState({about: '', avatar: '', cohort:'', name:'', _id: '', email: ''});\n\n    // хук для навигации с помощью brouser router\n    const history = useHistory();\n\n    const [editProfileState, setEditProfileState] = useState(false);\n    const [editAvatarState, setEditAvatarState] = useState(false);\n    const [addPlaceState, setAddPlaceState] = useState(false);\n    const [successfulRegState, setSuccessfulRegState] = useState(false);\n    const [errorRegState, setErrorRegState] = useState(false);\n    const [selectedCard, setSelectedCard] = useState({});\n    const [isLoading, setIsLoading] = useState(false);\n    const [emailNav, setEmailNav] = useState('');\n     function   finallyHandler(){\n        setIsLoading(false);\n    }\n    // стейт карточек\n    const [cards, setCards] = useState([]);\n    useEffect(() => {\n        renderResponse(api.getPreloadsCards(), (data)=>{\n            setCards(data);\n        }, \"#\")\n        renderResponse(api.getUserInfo(), (data) => {\n            setCurrentUser({...currentUser, about: data.about, avatar: data.avatar, cohort: data.cohort, name: data.name, _id: data._id});\n        }, \"#\")\n        if(localStorage.getItem('jwt')){\n            const jwt = localStorage.getItem('jwt');\n            authApi.getUserCredentials(jwt).then( ({email, _id}) => {\n                handleLoggedIn();\n                handleEmailNav(email);\n\n                history.push('/');\n            });\n\n        }\n    }, []);\n\n    // функции обратного вызова для управления поведением карточки\n    const handleCardLike = (card) => {\n        const isLiked = card.likes.some(like => like._id === currentUser._id);\n\n        renderResponse(api.changeLikeCardStatus(card._id, !isLiked), newCard => {\n            setCards((prevState) => {\n                return prevState.map( stateItem => {\n                    return stateItem._id === card._id ? newCard : stateItem;\n                });\n            });\n        }, finallyHandler);\n    }\n\n    const handleCardDelete = (card) => {\n\n        renderResponse(api.deleteCard(card._id), () => {\n            setCards(prevState => {\n                return prevState.filter( stateItem => stateItem._id !== card._id)\n            });\n        }, finallyHandler);\n\n    }\n\n    const handleAddMestoCard = ({name, link}) => {\n        setIsLoading(true);\n        renderResponse(api.postCard({name: name, link: link}), newCardData => {\n            setCards([newCardData, ...cards]);\n            setIsLoading(false);\n            closeAllPopups();\n        }, finallyHandler);\n    }\n\n    // функции обратного вызова для управления данными пользователя\n\n    const handleUpdateUser = ({name, about}) => {\n        setIsLoading(true);\n        renderResponse(api.updateUserInfo({fio: name, aboutYourself: about}),data => {\n            setCurrentUser({...currentUser, name: data.name, about: data.about})\n            setIsLoading(false);\n            closeAllPopups();\n        }, finallyHandler);\n\n    }\n\n    const handleUpdateAvatar = ({avatar}) => {\n        setIsLoading(true);\n        renderResponse(api.updateAvatar({avatar}), data => {\n            setCurrentUser({...currentUser, avatar: data.avatar});\n            setIsLoading(false);\n            closeAllPopups();\n        }, finallyHandler);\n    }\n\n    //обработчики для стейта авторизации\n    const handleLoggedIn = () => {\n        setAuthUser({...authUser, isLoggedIn: true});\n    }\n    const handleLoggOut = () => {\n        setAuthUser({...authUser, isLoggedIn: false});\n    }\n    const handleEmailNav = value => {\n        setEmailNav(value)\n    }\n\n    const [authUser, setAuthUser] = useState({isLoggedIn: false, handleLogin: handleLoggedIn, handleQuit: handleLoggOut, handleEmailNav: handleEmailNav});\n\n    // функции обратного вызова для открытия/закрытия попапов\n    const handleEditAvatarClick = () => {\n        setEditAvatarState(true);\n    }\n    const handleEditProfileClick = () => {\n        setEditProfileState(true);\n    }\n    const handleAddPlaceClick = () => {\n        setAddPlaceState(true);\n    }\n    const handleSuccessfullReg = () => {\n        setSuccessfulRegState(true);\n    }\n    const handleErrorReg = () => {\n        setErrorRegState(true);\n    }\n    const closeAllPopups = () => {\n        setEditProfileState(false);\n        setAddPlaceState(false);\n        setEditAvatarState(false);\n        setSuccessfulRegState(false);\n        setErrorRegState(false);\n        setSelectedCard({});\n    }\n\n    const handleCardClick = (card) => {\n        setSelectedCard(card);\n    }\n\n\n  return (\n      <AuthContext.Provider value={authUser}>\n          <CurrentUserContext.Provider value={currentUser}>\n\n\n              <Switch>\n\n                  <ProtectedComponent component={Main}\n                                      path=\"/\"\n                                      emailNav={emailNav}\n                                      \n                                      exact={true}\n                                      onEditProfile={handleEditProfileClick}\n                                      onAddPlace={handleAddPlaceClick}\n                                      onEditAvatar={handleEditAvatarClick}\n                                      onCardClick={handleCardClick}\n                                      onCardLike={handleCardLike}\n                                      onCardDelete={handleCardDelete}\n                                      cards={cards} />\n                  <Route path=\"/sign-up\">\n                      <Header />\n                      <Register onSuccessfullReg={handleSuccessfullReg} onErrorReg={handleErrorReg}/>\n                  </Route>\n                  <Route path=\"/sign-in\">\n                      <Header />\n                      <Login onErrorLoggedIn={handleErrorReg} onEmail={handleEmailNav}/>\n                  </Route>\n              </Switch>\n            <Footer />\n              <EditProfilePopup isOpen={editProfileState}\n                                onClose={closeAllPopups}\n                                onUserUpdate={handleUpdateUser}\n                                isLoading={isLoading}/>\n\n              <EditAvatarPopup isOpen={editAvatarState}\n                               onClose={closeAllPopups}\n                               onUpdateAvatar={handleUpdateAvatar}\n                               isLoading={isLoading}/>\n\n              <AddPlacePopup isOpen={addPlaceState}\n                             onClose={closeAllPopups}\n                             onAddCard={handleAddMestoCard}\n                             isLoading={isLoading}/>\n\n              <PopupWithForm name={\"confirm\"} title={\"Вы уверены?\"}/>\n\n              <ImagePopup card={selectedCard} onClose={closeAllPopups}/>\n\n              <AuthnNotificationPopup name=\"success-register\" isOpen={successfulRegState} onClose={closeAllPopups}>\n                  <img className=\"popup__reg-icon\" src={successIcon} alt=\"Иконка успешной регистрации\"/>\n                  <h2 className=\"popup__title popup__title_color_black popup__title_type_notification\">Вы успешно зарегестрировались!</h2>\n              </AuthnNotificationPopup>\n              <AuthnNotificationPopup name=\"error-register\" isOpen={errorRegState} onClose={closeAllPopups}>\n                  <img className=\"popup__reg-icon\" src={errorIcon} alt=\"Иконка неуспешной регистрации\"/>\n                  <h2 className=\"popup__title popup__title_color_black popup__title_type_notification\">Что-то пошло не так! Попробуйте ещё раз.</h2>\n              </AuthnNotificationPopup>\n\n          </CurrentUserContext.Provider>\n      </AuthContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}